# Twitter推文收藏器 Chrome插件

一个简单易用的Chrome浏览器插件，用于在Twitter/X推文旁边添加收藏按钮，一键保存推文到本地。

## 功能特点

- 🐦 **一键收藏**: 在每条推文旁添加收藏按钮
- 📁 **本地保存**: 将推文完整保存到用户指定的本地文件夹
- 🎨 **多种格式**: 支持JSON、HTML、Markdown三种保存格式
- 🖼️ **媒体下载**: 自动下载推文中的图片和视频
- ⚡ **实时更新**: 自动适配新发布的推文
- 🌙 **深色模式**: 完美适配Twitter的深色主题
- 📖 **本地浏览器**: 内置推文浏览器，可批量查看和管理收藏的推文
- 🔍 **搜索筛选**: 支持按内容、用户名搜索，按图片、时间筛选

## 安装方法

### 方法一：开发者模式安装（推荐）

1. 下载或克隆此项目到本地
2. 打开Chrome浏览器，访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹
6. 插件安装完成！

### 方法二：打包安装

1. 在Chrome扩展程序页面点击"打包扩展程序"
2. 选择项目文件夹进行打包
3. 将生成的.crx文件拖拽到Chrome扩展程序页面安装

## 使用方法

### 1. 配置设置

首次使用需要配置保存路径：

1. 点击浏览器工具栏中的插件图标
2. 设置推文保存路径（例如：`TwitterCollections`）
3. 选择保存格式（JSON/HTML/Markdown）
4. 选择是否同时下载媒体文件
5. 点击"保存设置"

### 2. 收藏推文

1. 访问 [Twitter](https://twitter.com) 或 [X](https://x.com)
2. 在任意推文的操作栏会看到新增的"收藏"按钮
3. 点击"收藏"按钮即可保存推文
4. 文件会自动下载到设置的路径中

### 3. 查看收藏

收藏的推文会保存在以下结构中：

```
您设置的路径/
├── tweet_用户名_时间戳.json/html/md
└── media/
    └── tweet_用户名_时间戳/
        ├── image_1.jpg
        ├── image_2.jpg
        └── video_1.mp4
```

### 4. 使用推文浏览器

1. 点击插件图标，在设置页面点击"📖 打开推文浏览器"
2. 在浏览器中点击"选择推文文件"，选择保存的推文文件
3. 支持批量选择多个文件，可以搜索和筛选推文
4. 点击推文卡片可查看详细内容

## 文件格式说明

### JSON格式
包含完整的推文数据结构，便于程序处理：
```json
{
  "userName": "用户名",
  "userHandle": "用户ID",
  "text": "推文内容",
  "tweetTime": "发布时间",
  "stats": {
    "replies": "回复数",
    "retweets": "转推数", 
    "likes": "点赞数"
  },
  "media": {
    "images": ["图片链接"],
    "videos": ["视频链接"]
  }
}
```

### HTML格式
美观的网页格式，便于浏览和分享

### Markdown格式
标准的Markdown文档格式，便于编辑和阅读

## 兼容性

- ✅ Chrome 88+
- ✅ Edge 88+
- ✅ 其他基于Chromium的浏览器
- ✅ Twitter.com
- ✅ X.com

## 权限说明

插件需要以下权限：

- `activeTab`: 访问当前标签页（用于在Twitter页面添加按钮）
- `storage`: 存储用户设置
- `downloads`: 下载文件到本地
- `host_permissions`: 访问Twitter/X网站

## 隐私保护

- 🔒 所有数据仅保存在本地，不会上传到任何服务器
- 🔒 不收集任何用户个人信息
- 🔒 不跟踪用户行为
- 🔒 开源代码，完全透明

## 故障排除

### 收藏按钮不显示
1. 刷新Twitter页面
2. 检查插件是否已启用
3. 确认网站权限是否正确

### 下载失败
1. 检查保存路径设置是否正确
2. 确认浏览器下载权限
3. 检查磁盘空间是否充足

### 媒体文件下载失败
1. 某些媒体文件可能有访问限制
2. 检查网络连接
3. 尝试手动下载测试

## 开发说明

### 项目结构
```
├── manifest.json      # 插件配置文件
├── content.js        # 内容脚本（在Twitter页面运行）
├── background.js     # 后台脚本（处理下载）
├── popup.html        # 设置界面HTML
├── popup.js          # 设置界面脚本
├── styles.css        # 样式文件
└── README.md         # 说明文档
```

### 技术栈
- Manifest V3
- Vanilla JavaScript
- Chrome Extension APIs
- CSS3

## 更新日志

### v1.1.3 - 2024-12-19 🔧
- **CSP修复**：修复Content Security Policy违规错误
- 移除所有内联事件处理器，改用标准事件监听
- 改进下载状态监听，修复"Download must be complete"错误
- 增强扩展上下文失效时的错误处理
- [查看完整更新日志](CHANGELOG.md)

### v1.1.2 - 2024-12-19 🚨
- **紧急修复**：修复v1.1.1中导致收藏失败的模板字符串错误
- 修复HTML格式无法正确保存的问题
- 增强数据验证，防止空值导致的模板错误
- 改进用户信息和推文内容的默认值处理

### v1.1.1 - 2024-12-19 🐛
- **重要修复**：修复HTML保存格式中出现无关图片的bug
- 优化图片提取逻辑，排除用户头像、表情符号和界面图标
- 改进媒体文件检测，只有真正的推文图片才会被保存
- 修复无图片推文在HTML格式中仍显示媒体部分的问题

### v1.1.0 - 2024-12-19 🎉
- **重大更新**：彻底解决设置保存问题
- 新增调试工具页面，支持实时诊断和问题修复
- 新增详细的使用帮助页面和常见问题解答
- 大幅改进错误处理机制和用户反馈
- 增强路径验证和文件下载逻辑
- 修复收藏按钮提示"请先设置保存路径"的问题

### v1.0.0 - 2024-12-18
- 初始版本发布
- 支持基本的推文收藏功能
- 支持多种文件格式
- 支持媒体文件下载

## 贡献

欢迎提交Issue和Pull Request！

## 许可证

MIT License

## 联系方式

如有问题或建议，请通过GitHub Issues联系。

---

**注意**: 请遵守Twitter的使用条款和相关法律法规，合理使用此插件。