# 更新日志

## [2.1.6] - 2025-08-24
### 📚 文档更新 (Documentation)
- **全面升级帮助文档**: 对 `help.html` 进行了彻底重写和重新设计，提供了更详尽、更美观的用户指南。
  - 新增了对 **推文串收藏**、**推文文章收藏** 和 **推文浏览器** 核心功能的详细说明。
  - 扩充了常见问题解答（FAQ），加入了图片恢复、路径设置等常见问题的解决方案。
  - 优化了文档的整体样式和排版，提升了可读性。

## [2.1.5] - 2025-08-24
### 🚀 新增 (Added)
- **推文文章完整支持**: 新增对Twitter/X推文文章的完整内容提取功能，支持长文、数学公式、结构化内容等复杂格式。

### 🐛 修复 (Fixed)
- **推文文章内容提取**: 修复了推文文章只能收集到预览文本（如"已置顶"）的问题，现在能够提取完整的文章内容，包括：
  - 长文章的完整文本内容（支持数千字符的文章）
  - 数学公式和百分比数据
  - 结构化的章节和段落
  - 详细的分析和说明内容
- **UI元素过滤**: 彻底清除收藏的内容中混入的界面元素，包括：
  - 移除"收藏中..."、"收藏串"等操作提示
  - 移除"11.8万 查看"、"1765231233"等浏览和互动数据
  - 移除"想发布自己的文章？升级为 Premium+"等推广信息
  - 移除时间戳和用户名重复
- **HTML格式优化**: 改善推文文章的HTML显示格式，提供更好的可读性和段落结构。

### 🛠️ 改进 (Improved)
- **内容去重**: 智能识别和移除重复内容，确保每段文字只出现一次。
- **文本清理**: 增强的文本清理算法，自动移除HTML标签、多余空白和无关字符。
- **调试日志优化**: 移除详细调试日志，提升扩展性能。

### 🎯 技术细节
- 新增专门的推文文章检测和提取逻辑
- 实现智能的UI元素识别和过滤机制
- 优化正则表达式匹配规则，提高内容清理精度
- 改进段落格式化算法，保持文章结构完整性

## [2.1.4] - 2025-07-16
### 🐛 修复 (Fixed)
- 根据谷歌商店的审核要求，移除了未使用的 `activeTab` 权限。

## [2.1.3] - 2025-07-14
### 🐛 修复 (Fixed)
- **图片清晰度问题**: 修复了在推特信息流主页（home timeline）收藏时，下载的图片为低分辨率缩略图的问题。现在无论是从主页还是从单条推文页面收藏，都能确保下载最高质量的原图。
- **增强图片URL处理**: 采用了更稳健的图片URL解析方式，并增加了异常处理。即使遇到非标准的图片URL格式，也能平滑回退，避免扩展程序发生崩溃，增强了程序的稳定性。

## [2.1.2] - 2025-07-13

### 🚀 新增 (Added)
- **一键保存推文串**: 实现了一键完整保存整个推文串的功能，包括所有推文内容和媒体文件。
- **多格式支持**: 推文串现在可以根据用户在设置中选择的文件类型（HTML, JSON, Markdown）被正确地保存为所有选定的格式。
- **推文浏览器记忆功能**: 新增推文数据自动保存和恢复功能
  - 推文内容自动保存到本地存储，重新打开后立即恢复
  - 支持过滤器状态记忆（搜索关键词、作者筛选、时间筛选等）
  - 新增"🔄 Reload Images"按钮，一键恢复推文图片
  - 新增"🗑️ Clear Data"按钮，支持清除所有保存的数据
  - 智能文件夹检测，自动识别相同文件夹并恢复图片

### 🐛 修复 (Fixed)
- **推文浏览器图片加载问题**: 解决了重新打开后图片无法显示的问题，现在提供便捷的图片重新加载功能

### 🐛 已知问题 (Known Issues)
- **推文浏览器显示不全**: 当使用推文浏览器加载一个包含多条推文的推文串HTML文件时，目前只会显示其中的第一条推文。
- **图片无法自动恢复**: 由于浏览器安全限制，图片需要用户重新选择文件夹来恢复，但推文文本内容会自动恢复。

## [2.1.0] - 2025-07-12

### 🚀 新增 (Added)
- **国际化支持**: 新增完整的中英文双语支持，使用Chrome扩展的i18n API实现本地化。
  - 添加了 `src/_locales/` 目录结构，包含英文（en）和简体中文（zh_CN）语言包
  - 支持344个本地化字符串，覆盖扩展的所有用户界面文本
  - 自动根据用户浏览器语言设置显示对应语言
  - 在 `manifest.json` 中配置了 `default_locale` 为英文，并使用 `__MSG_*__` 占位符

## [2.0.4] - 2025-07-12

### 🛠️ 改进 (Improved)
- **推文浏览器**: 作者筛选下拉菜单现在显示作者的名字而不是账号名，提升了用户体验。

## [2.0.3] - 2025-07-12

### 🛠️ 改进 (Improved)
- 优化了弹窗操作按钮的布局，将"推文浏览器"按钮调整为主按钮位置，并将"测试连接"按钮替换为"帮助文档"按钮，以提供更直观的用户体验。

### 🐛 修复 (Fixed)
- 修复了"帮助文档"按钮无法访问文件的问题，确保 `help.html` 在构建过程中被正确复制到发布目录，现在帮助页面可以正常打开。

## [2.0.2] - 2025-07-12

### 🚀 新增 (Added)
- 支持同时选择多种文件格式进行保存，将原有的下拉选择框改为多选复选框，提升了使用的灵活性。

## [2.0.1] - 2025-07-12

### 🐛 修复 (Fixed)
- 修复了因类型定义不一致导致在选择 "JSON" 或 "Markdown" 格式时收藏失败的问题。现在所有文件格式都能正常生成和保存。

## [2.0.0] - 2024-07-28

### 🎉 重大重构
- **核心迁移**: 整个扩展从 Vanilla JavaScript 完全重构为 **TypeScript**，提供了强类型支持，增强了代码的健壮性和可维护性。
- **构建系统**: 引入了基于 **Vite** 和 **Rollup** 的现代化构建流程，替代了之前的手动文件管理。
  - 为 Background Script (Service Worker), Popup, 和 Content Script 创建了独立的 Rollup 配置，解决了 ES 模块在扩展环境中不兼容的问题。
  - 实现了自动化的构建、清理和资源复制 (`npm run build`)。
- **项目结构**: 采用了全新的 `src` 目录结构，按功能模块（`background`, `content`, `popup`, `utils` 等）组织源代码，使项目结构更清晰。

### 🐛 修复 (Fixed)
- 解决了 Service Worker 因 ES 模块导入而无法注册的致命问题。
- 解决了后台脚本中因调用 `document` 和 `URL.createObjectURL` 等浏览器端 API 导致的崩溃问题，改用兼容 Service Worker 的实现。
- 修正了构建脚本中资源文件（图标、HTML页面等）丢失，导致功能不完整的问题。
- 统一了 `manifest.json`, `package.json` 中的版本号，解决了版本混乱的问题。

### 🛠️ 改进 (Improved)
- **稳定性**: 通过重构和一系列关键修复，插件的稳定性和可靠性得到大幅提升。
- **可维护性**: TypeScript 和模块化的引入，使得未来添加新功能和修复问题变得更加容易。
- **开发效率**: 现代化的构建流程极大地提升了开发和调试的效率。

## [1.2.0] - 2024-12-20

### 🚀 新增 (Added)
- 保存推文时，会自动下载作者的头像。
- 重构了文件保存逻辑，现在每条推文及其所有媒体文件（包括头像）都会保存在一个以推文信息命名的独立文件夹中，解决了路径混乱问题。

### 🐛 修复 (Fixed)
- 彻底修复了推文浏览器无法显示作者头像的bug，现在能够正确解析和展示本地头像文件。

### 🔧 技术改进
- 添加了 `.cursorrules` 文件，为项目引入了统一的、专业的开发规范。
- 改进了 `background.js` 中的媒体下载逻辑，使其更具模块化和健壮性。
- 改进了 `tweet-browser.js` 中的路径解析逻辑，以适应新的文件结构。

## [1.1.9] - 2024-12-19

### 🐛 修复 (Fixed)
- 修复了推文浏览器中因HTML转义导致推文正文显示为原始标签（乱码）的问题。

### 🛡️ 安全更新
- 对推文浏览器中的用户名和用户Handle进行HTML转义，增强了安全性。

## [1.1.8] - 2024-12-19

### 🚀 新增 (Added)
- 在HTML文件和推文浏览器中添加"查看原文"按钮，方便快速追溯原始推文。

### 🐛 修复 (Fixed)
- 修正了推文浏览器无法正确解析和显示推文统计数据（回复、转推、点赞）的问题。

## [1.1.7] - 2024-12-19

### 🎨 界面改进
- **全新弹出界面**：完全重新设计了弹出设置界面，使其更简洁、美观和用户友好。
- **简化布局**：移除了功能描述、调试工具、帮助和重置按钮，聚焦核心设置。
- **视觉增强**：引入了卡片式设计、柔和的背景渐变、更清晰的字体层级以及emoji点缀，提升了整体美感。
- **修复对齐问题**：彻底解决了输入框和按钮的垂直对齐问题，使界面更规整。

### 🐛 修复 (Fixed)
- 修复了推文浏览器在导入包含不完整数据的JSON文件时，会卡在"正在加载"界面的问题。

## [1.1.6] - 2024-12-19

### 🐛 修复 (Fixed)
- 修复推文浏览器因内容安全策略（CSP）限制导致无法导入文件的问题
- 将内联JavaScript代码重构为外部文件（tweet-browser.js）以符合Manifest V3安全规范

### 🔧 技术改进
- 遵循CSP最佳实践，提高了扩展页面的安全性
- 优化了推文浏览器页面的脚本加载逻辑

## [1.1.5] - 2024-12-19

### 🚀 新增 (Added)
- **修复保存路径无法修改的问题**：用户现在可以完全控制保存路径设置
- **新增路径选择对话框**：点击"选择路径"按钮会弹出友好的路径选择界面
- **支持绝对路径**：用户可以使用完整的文件夹路径（如：C:/MyFolder/Twitter）
- **支持相对路径**：保持对相对路径的完整支持（如：Downloads/Twitter）

### 🛠️ 改进 (Improved)
- 优化路径验证逻辑，区分绝对路径和相对路径的验证规则
- 改进路径清理算法，正确处理不同格式的路径
- 提供路径类型提示，帮助用户了解当前路径格式
- 增强对话框界面，支持鼠标点击、ESC键等多种交互方式

### 📚 文档更新
- 更新帮助文档，详细说明绝对路径和相对路径的使用方法
- 提供丰富的路径示例，覆盖Windows、Linux、Mac系统
- 增强路径注意事项说明，帮助用户避免常见错误

### 🎨 界面改进
- 更新输入框占位符，提供更清晰的示例
- 改进按钮文本，从"浏览"改为"选择路径"
- 增加路径类型验证反馈，实时提示用户输入状态

## [1.1.4] - 2024-01-XX

### 🐛 修复 (Fixed)
- 修复Chrome扩展上下文失效导致的"Cannot read properties of undefined (reading 'sendMessage')"错误
- 增强Chrome扩展API可用性检查，避免在扩展失效时调用API
- 改进错误处理机制，提供更准确的错误信息
- 优化sendMessage调用，使用Promise包装以更好地处理异步错误

### 🛠️ 改进 (Improved)
- 增强用户反馈机制，根据不同错误类型显示相应提示
- 优化错误信息显示，区分"扩展失效"、"连接失败"、"提取失败"等不同情况
- 提高插件的稳定性和可靠性

## [1.1.3] - 2024-01-XX

### 🐛 修复 (Fixed)
- 修复Content Security Policy (CSP) 违规问题
- 移除HTML文件中的内联事件处理器（onclick、onload等）
- 改进下载过程的错误处理和状态监听
- 修复扩展上下文失效导致的错误

### 🛠️ 改进 (Improved)
- 使用addEventListener替代内联事件处理
- 增强下载完成状态检查
- 添加下载超时保护机制

## [1.1.2] - 2024-01-XX

### 🐛 修复 (Fixed)
- 修复模板字符串中的空值处理问题
- 改进HTML和Markdown生成的错误处理
- 确保所有模板变量都有默认值保护

### 🛠️ 改进 (Improved)
- 移除可能干扰运行的调试日志
- 优化错误信息显示

## [1.1.1] - 2024-01-XX

### 🐛 修复 (Fixed)
- 修复图片提取bug，避免保存无关图片（头像、表情符号等）
- 改进图片选择器，使用更精确的匹配规则
- 优化媒体文件下载逻辑

### 🛠️ 改进 (Improved)
- 更好的媒体内容识别
- 改进HTML和Markdown格式的媒体部分显示

## [1.1.0] - 2024-01-XX

### 🚀 新增 (Added)
- HTML格式导出功能
- Markdown格式导出功能
- 媒体文件下载支持
- 调试工具页面
- 帮助页面
- 推文浏览器功能

### 🛠️ 改进 (Improved)
- 更好的用户界面
- 增强的交互体验
- 更详细的错误信息

## [1.0.0] - 2024-01-XX

### 🚀 新增 (Added)
- 初始版本发布
- 基础推文收藏功能
- JSON格式导出
- 支持Twitter和X.com域名
- 推文数据提取和保存

---

## 版本说明

### 版本号规则
采用语义化版本控制 (Semantic Versioning)：
- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 图标说明
- 🎉 重大功能
- 🚀 新增功能
- 🛠️ 改进优化  
- 🐛 修复问题
- 🔧 技术改进
- 📚 文档更新
- 🛡️ 安全更新
- ⚡ 性能优化
- 🎨 界面改进 